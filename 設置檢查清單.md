# 設置檢查清單

請按照以下清單逐步檢查，確保系統能正常運行。

## ✅ 前置需求檢查

- [ ] Python 3.8+ 已安裝
  ```bash
  python --version
  ```

- [ ] PostgreSQL 12+ 已安裝並運行
  ```bash
  psql --version
  # Windows: 檢查服務管理員中 postgresql 服務是否運行
  ```

- [ ] MongoDB Atlas 帳號已準備（或本地 MongoDB 已安裝）

## ✅ 步驟 1：安裝依賴

- [ ] 進入後端目錄
  ```bash
  cd .backend
  ```

- [ ] 安裝 Python 依賴
  ```bash
  pip install -r requirements.txt
  ```

- [ ] 確認安裝成功（無錯誤訊息）

## ✅ 步驟 2：設定環境變數

- [ ] 複製環境變數範例檔
  ```bash
  copy env.example .env
  ```

- [ ] 編輯 `.env` 檔案，設定以下內容：
  - [ ] `DB_PASSWORD` - 您的 PostgreSQL 密碼
  - [ ] `MONGO_URI` - 您的 MongoDB Atlas 連接字串（或使用本地 MongoDB 設定）
  - [ ] `JWT_SECRET` - 可保持預設值或自行修改

## ✅ 步驟 3：確認資料庫服務

### PostgreSQL

- [ ] PostgreSQL 服務運行中
  - Windows: 服務管理員 → 找到 postgresql 服務 → 確認狀態為「執行中」

- [ ] 測試連接
  ```bash
  psql -U postgres -h localhost
  ```
  - [ ] 能成功連接（輸入密碼後進入 psql）

- [ ] 資料庫已建立
  ```sql
  -- 在 psql 中執行
  \l
  -- 確認看到 campus_trading 資料庫
  ```

### MongoDB

- [ ] MongoDB Atlas Cluster 狀態為 "Running"
- [ ] IP 白名單已設定（允許所有 IP：`0.0.0.0/0`）
- [ ] 連接字串已複製到 `.env` 檔案

## ✅ 步驟 4：還原資料庫

### PostgreSQL 還原

- [ ] 選擇還原方式：
  - [ ] 使用 `.backup` 檔案（推薦）
    ```bash
    $env:PGPASSWORD="你的密碼"
    pg_restore -h localhost -p 5432 -U postgres -d campus_trading -c database_backups/postgresql_campus_trading_20251210_004949.backup
    ```
  - [ ] 或使用 `.sql` 檔案
    ```bash
    $env:PGPASSWORD="你的密碼"
    psql -h localhost -p 5432 -U postgres -d campus_trading < database_backups/postgresql_campus_trading_20251210_004453.sql
    ```
  - [ ] 或從頭初始化（無測試資料）
    ```bash
    cd .backend
    python database/init_db.py
    ```

- [ ] 確認還原成功
  ```bash
  psql -U postgres -d campus_trading
  \dt
  -- 應該看到所有資料表
  ```

### MongoDB

- [ ] 如果使用 MongoDB Atlas：確認連接字串正確（已在雲端，無需還原）
- [ ] 如果使用本地 MongoDB：執行初始化
  ```bash
  cd .backend
  python database/mongodb_schema.py
  ```

## ✅ 步驟 5：測試後端

- [ ] 啟動後端服務
  ```bash
  cd .backend
  python app.py
  ```

- [ ] 確認後端運行成功
  - [ ] 看到訊息：`* Running on http://127.0.0.1:5000`
  - [ ] 無錯誤訊息

- [ ] 測試 API
  - [ ] 開啟瀏覽器訪問 `http://localhost:5000/`
  - [ ] 應該看到 JSON 回應
  - [ ] 訪問 `http://localhost:5000/api/products`
  - [ ] 應該看到商品列表（可能為空陣列 `[]`）

## ✅ 步驟 6：測試前端

- [ ] 啟動前端服務（新開終端視窗）
  ```bash
  cd .frontend
  python -m http.server 8000
  ```

- [ ] 確認前端運行成功
  - [ ] 看到訊息：`Serving HTTP on :: port 8000`

- [ ] 開啟網站
  - [ ] 在瀏覽器訪問 `http://localhost:8000`
  - [ ] 應該看到首頁

- [ ] 測試註冊功能
  - [ ] 點擊「註冊」
  - [ ] 填寫註冊表單
  - [ ] 確認註冊成功

- [ ] 測試登入功能
  - [ ] 使用註冊的帳號登入
  - [ ] 確認登入成功（右上角顯示使用者名稱）

## ✅ 步驟 7：功能測試

- [ ] 商品上架
  - [ ] 點擊「上架商品」
  - [ ] 填寫商品資訊
  - [ ] 確認上架成功

- [ ] 商品瀏覽
  - [ ] 在首頁看到商品列表
  - [ ] 點擊商品查看詳情

- [ ] 交易請求
  - [ ] 對商品提出購買請求
  - [ ] 確認請求建立成功

## ⚠️ 如果遇到問題

### 後端無法啟動
- [ ] 檢查 Python 依賴是否安裝完整
- [ ] 檢查 `.env` 檔案是否存在且正確
- [ ] 檢查資料庫服務是否運行

### 資料庫連接失敗
- [ ] 檢查 PostgreSQL 服務是否運行
- [ ] 檢查 `.env` 中的密碼是否正確
- [ ] 測試手動連接資料庫

### 前端無法連接後端
- [ ] 確認後端服務運行中
- [ ] 檢查瀏覽器 Console（F12）的錯誤訊息
- [ ] 確認兩個服務都在運行

### 登入問題
- [ ] 清除瀏覽器快取（Ctrl + Shift + R）
- [ ] 檢查瀏覽器 Console 的錯誤訊息
- [ ] 確認 JWT Token 是否正確儲存

---

**完成所有檢查項目後，系統應該能正常運行！**

如有問題，請參考：
- `README.md` - 完整設置指南
- `啟動說明.md` - 詳細啟動說明和故障排除



